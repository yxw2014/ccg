# -*- coding: utf-8 -*-

from  django.http import HttpResponse
from  HeroModel import HeroModel
import json

from vo import *
from base import Base
import bson

class HeroService(Base):
	'''
	@classmethod
	def getAllHeros(self):
		hero = HeroModel()
		ret= hero.getAllHeros()
		obj= HeroVO()
		ret= makeVo(ret, obj)
		return ret
	'''
	@classmethod
	def getAllSystemAndUserHeros(self, params):
		uuid= params[0]
		hero = HeroModel()
		ret= hero.getAllSystemAndUserHeros(uuid)
		'''
		data=[]
		for r in ret:
			data.append({'jobCards': r.get('jobCards'), 'job': r.get('job'), 'type': r.get('type'), '_id': r.get('_id'), 'aliasName': r.get('aliasName')})
		'''
		obj= HeroVO()
		ret= makeVo(ret, obj)
		return ret

	@classmethod
	def getSystemOrUserHerosById(self, params):
		uuid= params[0]
		id= params[1]

		if uuid== None or id== None:
			return -1

		hero = HeroModel()
		ret= hero.getSystemOrUserHerosById(uuid, id)
		#data={'jobCards': ret.get('jobCards'), 'job': ret.get('job'), 'type': ret.get('type'), '_id': ret.get('_id'), 'aliasName': ret.get('aliasName')}


		obj= HeroVO()
		ret= makeVo(ret, obj)
		return ret

	@classmethod
	def updateUserHeros(self, params):
		uuid, id, cardIds= params[0], int(params[1]), params[2]
		if uuid== None or id== None or cardIds== None:
			return -1

		hero = HeroModel()
		ret= hero.updateUserHeros(id, cardIds)
		print params
		print ret
		if isinstance(ret, dict)== True:
			params= [uuid, id]
			return self.getSystemOrUserHerosById(params)	
		else:
			return -2

	@classmethod
	#def createUserHeros(self, uuid, job, name, cardIds):
	def createUserHeros(self, params):
		uuid, job, name, cardIds= params[0], params[1], params[2], params[3]
		if uuid== None or job== None or name== None or cardIds== None:
			return -1
		
		#if(cardIds.find(',')<0):
			#return -2

		name= name.strip()
		#ids= cardIds.split(',')
		hero = HeroModel()
		ret= hero.createUserHeros(uuid, job, name, cardIds)
		if isinstance(ret, int)== True:
			params= [uuid, ret]
			return self.getSystemOrUserHerosById(params)	
		else:
			return -2
		



