# -*- coding: utf-8 -*-

import sys,os,time
import json, struct
from config import config

class request:
    def __init__(self, data): 
        if(isinstance(data, dict)== False):            
            return False
        self.version= '2013111910'
        self.uid= data["uuid"]      
        self.service= data["service"]
        self.method= data["method"]
        self.params= data["params"]
        self.params['uuid']= self.uid
        
    def dump(self): 
        obj = {"uid": self.uid, "service": self.service,  "method": self.method, "version": str(self.version), "params": self.params}
        try: 
            encodedjson = json.dumps(obj) 
            encodedjson= (encodedjson+ config['GAME']['msgsuffix'])
            encodedjson= struct.pack(str(len(encodedjson))+'s', encodedjson)  
            return encodedjson  
        except:
            print 'json.dumps except',obj
            
        
        
if __name__ == '__main__':  
    c= request({})
    print c.dump()